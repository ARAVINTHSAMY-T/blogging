<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact | BlogSpace</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root {
      /* Light theme (default) */
      --primary-color: #1d1d1f;
      --secondary-color: #86868b;
      --accent-color: #0071e3;
      --accent-hover: #0077ed;
      --background: #f5f5f7;
      --card-bg: #ffffff;
      --text-primary: #1d1d1f;
      --text-secondary: #515154;
      --text-tertiary: #86868b;
      --border-color: #d2d2d7;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.07);
      --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    /* Dark theme */
    [data-theme="dark"] {
      --primary-color: #f5f5f7;
      --secondary-color: #86868b;
      --accent-color: #0071e3;
      --accent-hover: #0077ed;
      --background: #1d1d1f;
      --card-bg: #2d2d2f;
      --text-primary: #f5f5f7;
      --text-secondary: #a1a1a6;
      --text-tertiary: #86868b;
      --border-color: #424245;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--background);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-color);
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    [data-theme="dark"] header {
      background: rgba(45, 45, 47, 0.8);
    }

    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 90%;
      max-width: 1200px;
      margin: auto;
    }

    .brand {
      font-size: 24px;
      font-weight: 700;
      text-decoration: none;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand i {
      color: var(--accent-color);
    }

    .nav-links {
      display: flex;
      gap: 30px;
    }

    .nav-links a {
      text-decoration: none;
      color: var(--text-secondary);
      font-weight: 500;
      font-size: 17px;
      transition: var(--transition);
      position: relative;
    }

    .nav-links a:hover {
      color: var(--text-primary);
    }

    .nav-links a.active {
      color: var(--text-primary);
    }

    .nav-links a.active::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--accent-color);
    }

    .profile-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(0, 0, 0, 0.03);
      padding: 8px 16px;
      border-radius: 20px;
      color: var(--text-primary);
      font-weight: 500;
      transition: var(--transition);
    }

    .profile-bar:hover {
      background: rgba(0, 0, 0, 0.06);
    }

    .profile-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      object-fit: cover;
      border: 1px solid var(--border-color);
    }

    .theme-toggle {
      background: none;
      border: none;
      color: var(--text-primary);
      font-size: 18px;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: var(--transition);
      margin-left: 10px;
    }

    .theme-toggle:hover {
      background: rgba(0, 0, 0, 0.1);
    }

    [data-theme="dark"] .theme-toggle {
      color: var(--text-primary);
    }

    .contact-section {
      width: 90%;
      max-width: 1200px;
      margin: 60px auto;
      display: flex;
      gap: 40px;
      align-items: flex-start;
    }

    .contact-container {
      background: var(--card-bg);
      padding: 40px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      flex: 1;
      transition: var(--transition);
    }

    .contact-container:hover {
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .contact-container h2 {
      text-align: center;
      color: var(--accent-color);
      margin-bottom: 20px;
      font-weight: 700;
      font-size: 32px;
    }

    .contact-container p {
      text-align: center;
      color: var(--text-secondary);
      margin-bottom: 25px;
      font-size: 17px;
    }

    .contact-container input,
    .contact-container textarea {
      width: 100%;
      padding: 14px 16px;
      margin: 12px 0;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 16px;
      outline: none;
      background: var(--background);
      transition: var(--transition);
      font-family: inherit;
    }

    .contact-container input:focus,
    .contact-container textarea:focus {
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
    }

    .contact-container button {
      width: 100%;
      padding: 16px;
      background: var(--accent-color);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 10px;
    }

    .contact-container button:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }

    .map-container {
      flex: 1;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
    }

    .map-container:hover {
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .map-container h3 {
      padding: 20px;
      text-align: center;
      color: var(--text-primary);
      font-weight: 600;
      border-bottom: 1px solid var(--border-color);
      margin: 0;
    }

    #map {
      height: 400px;
      width: 100%;
      border-radius: 0 0 20px 20px;
    }

    /* Custom Leaflet styles */
    .leaflet-container {
      background: var(--background);
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .leaflet-popup-content-wrapper {
      background: var(--card-bg);
      color: var(--text-primary);
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    .leaflet-popup-tip {
      background: var(--card-bg);
    }

    .custom-marker {
      background: var(--accent-color);
      border: 3px solid white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    footer {
      background: var(--primary-color);
      color: var(--text-tertiary);
      text-align: center;
      padding: 40px 20px;
      margin-top: auto;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 20px;
    }

    .footer-links a {
      color: var(--text-tertiary);
      text-decoration: none;
      transition: var(--transition);
    }

    .footer-links a:hover {
      color: white;
    }

    .copyright {
      font-size: 14px;
    }

    @media (max-width: 1024px) {
      .contact-section {
        flex-direction: column;
      }
      
      .contact-container, .map-container {
        width: 100%;
      }
    }

    @media (max-width: 768px) {
      .nav {
        flex-direction: column;
        gap: 20px;
      }
      
      .nav-links {
        gap: 20px;
      }
      
      .contact-container {
        padding: 30px 25px;
      }
    }

    @media (max-width: 576px) {
      .nav-links {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .footer-links {
        flex-direction: column;
        gap: 15px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <a class="brand" href="home.html">
        <i class="fas fa-apple-alt"></i>
        BlogSpace
      </a>
      <nav class="nav-links">
        <a href="home.html">Home</a>
        <a href="post.html">Posts</a>
        <a href="about.html">About</a>
        <a href="contact.html" class="active">Contact</a>
        <a href="profile.html">Profile</a>
      </nav>
      <div class="profile-bar">
        <img id="profileBarAvatar" class="profile-avatar" src="https://ui-avatars.com/api/?name=User&background=0071e3&color=fff" alt="Profile">
        <a id="profileName" href="profile.html" style="color:inherit;text-decoration:none;">User</a>
        <a href="#" id="logoutBtn" style="color:inherit;margin-left:10px;">
          <i class="fas fa-sign-out-alt"></i>
        </a>
      </div>
      <button id="themeToggle" class="theme-toggle" title="Toggle theme">
        <i class="fas fa-moon"></i>
      </button>
    </div>
  </header>

  <div class="contact-section">
    <div class="contact-container">
      <h2>Contact Me</h2>
      <p>Have a question or just want to say hi? I'd love to hear from you.</p>
      <form action="mailto:youremail@example.com" method="post" enctype="text/plain">
        <input type="text" name="name" placeholder="Your Name" required>
        <input type="email" name="email" placeholder="Your Email" required>
        <textarea name="message" rows="5" placeholder="Your Message" required></textarea>
        <button type="submit">Send Message</button>
      </form>
    </div>

    <div class="map-container">
      <h3>Find Me in Erode, Tamil Nadu</h3>
      <div id="map"></div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="home.html">Home</a>
        <a href="post.html">Posts</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
        <a href="profile.html">Profile</a>
      </div>
      <p class="copyright">© 2025 BlogSpace • Crafted by developers</p>
    </div>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script>
    // Initialize Leaflet Map
    function initMap() {
      // Erode, Tamil Nadu coordinates
      const erode = [11.3410, 77.7172];
      
      // Create map
      const map = L.map('map').setView(erode, 12);
      
      // Add OpenStreetMap tiles
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors',
        maxZoom: 18
      }).addTo(map);
      
      // Custom icon
      const customIcon = L.divIcon({
        className: 'custom-marker',
        iconSize: [20, 20],
        iconAnchor: [10, 10]
      });
      
      // Add marker
      const marker = L.marker(erode, { icon: customIcon }).addTo(map);
      
      // Add popup
      marker.bindPopup(`
        <div style="padding: 10px; min-width: 200px;">
          <h3 style="margin: 0 0 8px 0; color: #1d1d1f; font-size: 16px;">Erode, Tamil Nadu</h3>
          <p style="margin: 0; color: #515154; font-size: 14px;">Textile City of South India</p>
          <p style="margin: 8px 0 0 0; color: #0071e3; font-size: 13px;">
            <i class="fas fa-map-marker-alt"></i> Located in Tamil Nadu, India
          </p>
        </div>
      `).openPopup();
      
      // Add click event to open popup
      marker.on('click', function() {
        marker.openPopup();
      });
    }

    // Initialize map when page loads
    document.addEventListener('DOMContentLoaded', function() {
      initMap();
      
      // Set user info - use custom name if available, otherwise use logged-in user
      const user = localStorage.getItem('loggedInUser') || 'User';
      const customName = localStorage.getItem('customName');
      const displayName = customName || user;
      document.getElementById('profileName').textContent = displayName;
      
      const avatar = localStorage.getItem('profileAvatar');
      const avatarImg = document.getElementById('profileBarAvatar');
      if (avatar) {
        avatarImg.src = avatar;
      } else {
        avatarImg.src = `https://ui-avatars.com/api/?name=${user}&background=0071e3&color=fff`;
      }
    });

    // Listen for profile updates from other pages
    const profileChannel = new BroadcastChannel('profile-updates');
    profileChannel.onmessage = (event) => {
      if (event.data.type === 'profile-updated') {
        // Update profile display with new data
        const profileName = document.getElementById('profileName');
        const profileBarAvatar = document.getElementById('profileBarAvatar');

        const customName = event.data.data.customName;
        const avatar = event.data.data.avatar;

        if (customName && profileName) {
          profileName.textContent = customName;
        }

        if (avatar && profileBarAvatar) {
          profileBarAvatar.src = avatar;
        } else if (profileBarAvatar) {
          // Check if there's a saved avatar in localStorage
          const savedAvatar = localStorage.getItem('profileAvatar');
          if (savedAvatar) {
            profileBarAvatar.src = savedAvatar;
          }
        }
      }
    };

    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    const html = document.documentElement;

    // Check for saved theme preference or default to light mode
    const currentTheme = localStorage.getItem('theme') || 'light';
    html.setAttribute('data-theme', currentTheme);

    // Update button icon based on current theme
    function updateThemeIcon() {
      const icon = themeToggle.querySelector('i');
      if (html.getAttribute('data-theme') === 'dark') {
        icon.className = 'fas fa-sun';
      } else {
        icon.className = 'fas fa-moon';
      }
    }

    updateThemeIcon();

    // Toggle theme
    themeToggle.addEventListener('click', () => {
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeIcon();
    });

    // Logout functionality
    document.getElementById("logoutBtn").addEventListener("click", function(e) {
      e.preventDefault();
      (async () => {
        try {
          const module = await import('./auth.js');
          await module.logout();
        } catch (_) {}
        localStorage.removeItem("loggedInUser");
        window.location.href = "first_page.html";
      })();
    });
  </script>
</body>
</html>